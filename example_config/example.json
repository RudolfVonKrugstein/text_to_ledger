{
  "input": {
    "type": "directory",
    "name": "home bank statements",
    "directory": "/home/nathan/bank_statements/"
  },
  "extractors": [{
    "type": "text",
    "sheet":{
      "regexes": [
        "Kontonummer (?<an>[0-9]{10})",
        "neuer Kontostand (v\\.|vom) +(?<ed>[0-9]{1,2}\\.[0-9]{2}\\.[0-9]{4}) +(?<ea>[0-9\\.]*,[0-9]{2}) (?<es>[HS])",
        "alter Kontostand vom (?<sd>[0-9]{1,2}\\.[0-9]{2}\\.[0-9]{4}) +(?<sa>[0-9\\.]*,[0-9]{2}) (?<ss>[HS])"
      ],
      "values": {
        "account": "{an}",
        "bank": "GLS Bank",
        "start_amount": "{ss|r(H,)|r(S,-)}{sa|r(.,)|r(\\,,.)} EUR",
        "end_amount": "{es|r(H,)|r(S,-)}{ea|r(.,)|r(\\,,.)} EUR",
        "start_date": "{sd}",
        "end_date": "{ed}"
      }
    },
    "transaction_areas": {
      "start": {
        "regex": "(alter Kontostand vom|Übertrag von Blatt).*$",
        "split": "after"
      },
      "end": {
        "regex": "^.*(Übertrag auf Blatt|neuer Kontostand vom)",
        "split": "before"
      },
      "subarea": {
        "start": "[0-9]{2}\\.[0-9]{2}\\. +[0-9]{2}\\.[0-9]{2}\\.",
        "end": "\\n\\n"
      }
    }
  }],
  "enrichers": [
    {
      "name": "date, amount and subject",
      "regexes": [
        "(?<bd>[0-9]{2}\\.[0-9]{2}\\.) +[0-9]{2}\\.[0-9]{2}\\. +(?<line1>.+) +(?<a>[0-9\\.]*,[0-9]{2}) (?<as>[HS])",
        {
          "regex": "^ +(?<lines>[^ \n].*[^ \n])$",
          "optional": true
        }
      ],
      "values": {

        "date": "{bd}",
        "amount": "{as|r(H,)|r(S,-)}{a|r(.,)|r(\\,,.)} EUR",
        "subject": "{line1}{lines|concat()}"
      }
    },{
      "name": "Tante Rübe", 
      "regexes": [
        {
          "regex": ".*Tante Rübe.*",
          "on": "subject"
        },
        {
          "regex": "assets:checking:private",
          "on": "source_account"
        }
      ],
      "values": {
        "payee": "Tante Rübe",
        "target_account": "expenses:food:grocery:tanteruebe"
      }
    }
  ]
}
